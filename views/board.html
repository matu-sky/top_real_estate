<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= board.name %> | 탑 부동산</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <header id="header">
        <div class="container header-container">
            <div class="logo">
                <a href="/"><%= content.header_logo_text %></a>
            </div>
            <nav>
                <ul>
                    <% content.header_nav_links.forEach(link => { %>
                        <li><a href="<%= link.url %>"><%= link.text %></a></li>
                    <% }); %>
                </ul>
            </nav>
            <div class="mobile-menu-btn">☰</div>
        </div>
    </header>

    <main class="container board-container">
        <div class="board-header">
            <h2><%= board.name %></h2>
            <p><%= board.description %></p>
        </div>

        <table class="board-table">
            <thead>
                <tr>
                    <th class="id">번호</th>
                    <th class="title">제목</th>
                    <th class="author">작성자</th>
                    <th class="date">작성일</th>
                </tr>
            </thead>
            <tbody>
                <% posts.forEach((post, index) => { %>
                    <tr>
                        <td><%= totalPosts - ((currentPage - 1) * postsPerPage) - index %></td>
                        <td><a href="/board/<%= board.slug %>/<%= post.id %>"><%= post.title %></a></td>
                        <td><%= post.author %></td>
                        <td><%= new Date(post.created_at).toLocaleDateString('ko-KR') %></td>
                    </tr>
                <% }); %>

                <% if (posts.length === 0) { %>
                    <tr>
                        <td colspan="4" class="no-posts">게시글이 없습니다.</td>
                    </tr>
                <% } %>
            </tbody>
        </table>

        <div class="board-footer" style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
            <div class="search-form">
                <form action="/board/<%= board.slug %>" method="GET" style="display: flex;">
                    <input type="text" name="search" placeholder="검색어 입력" value="<%= typeof search !== 'undefined' ? search : '' %>" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <button type="submit" class="btn-primary" style="margin-left: 5px;">검색</button>
                </form>
            </div>
            
            <div class="pagination" style="display: flex; justify-content: center; flex-grow: 1;">
                <% if (totalPages > 1) { %>
                    <% for (let i = 1; i <= totalPages; i++) { %>
                        <a href="/board/<%= board.slug %>?page=<%= i %>&search=<%= typeof search !== 'undefined' ? search : '' %>" class="<%= currentPage == i ? 'active' : '' %>" style="padding: 5px 10px; margin: 0 2px; border: 1px solid #ddd; text-decoration: none; color: #333; <%= currentPage == i ? 'background-color: #007bff; color: white; border-color: #007bff;' : '' %>">
                            <%= i %>
                        </a>
                    <% } %>
                <% } %>
            </div>

            <div class="write-button">
                <% if (user && user.loggedin) { %>
                    <a href="/board/<%= board.slug %>/write" class="btn-primary">글쓰기</a>
                <% } %>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-info">
                <p>
                    <strong>상호:</strong> <%= content.footer_company_name %><span>|</span>
                    <strong>대표자:</strong> <%= content.footer_ceo_name %><span>|</span>
                    <strong>주소:</strong> <%= content.footer_address %><br>
                    <strong>사업자등록번호:</strong> <%= content.footer_business_license %><span>|</span>
                    <strong>중개업등록번호:</strong> <%= content.footer_registration_number %><span>|</span>
                    <strong>통신판매업신고번호:</strong> <%= content.footer_mail_order_license %><span>|</span>
                    <strong>전화번호:</strong> <%= content.footer_phone %>
                </p>
            </div>
            
            <div class="footer-menu">
                <% content.footer_links.forEach(link => { %>
                    <a href="<%= link.url %>"><%= link.text %></a>
                <% }); %>
                <a href="/login">관리자</a>
            </div>

            <div class="copyright">
                <p><%= content.footer_copyright %></p>
            </div>
        </div>
    </footer>
</body>
</html>